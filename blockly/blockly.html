<html>
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="blockly_compressed.js"></script>
    <script type="text/javascript" src="blocks_compressed.js"></script>
    <script type="text/javascript" src="en.js"></script>
    <script type="text/javascript" src="javascript_compressed.js"></script>
    <script type="text/javascript" src="blockly_espruino.js"></script>
    <script type="text/javascript" src="field_textarea.js"></script>
    <style>
      html, body {
        background-color: #fff;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
      .blocklySvg {
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>

  <!-- Blockly toolbox -->
  <xml id="toolbox" style="display: none">
    <category name="Logic">
      <block type="controls_if"></block>
      <block type="logic_compare"></block>
      <block type="logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
      <block type="logic_ternary"></block>
    </category>
    <category name="Control">      
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <block type="math_number">
            <title name="NUM">10</title>
          </block>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
      <block type="controls_for">
        <value name="FROM">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <title name="NUM">10</title>
          </block>
        </value>
        <value name="BY">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
      </block>
      <block type="controls_forEach"></block>
      <block type="controls_flow_statements"></block>
    </category>    
    <category name="Math">
      <block type="math_number">
        <title name="NUM">0</title>
      </block>
      <block type="math_arithmetic">
        <title name="OP">ADD</title>
      </block>
      <block type="math_single">
        <title name="OP">ROOT</title>
      </block>
      <block type="math_trig">
        <title name="OP">SIN</title>
      </block>
      <block type="math_constant">
        <title name="CONSTANT">PI</title>
      </block>
      <block type="math_number_property">
        <mutation divisor_input="false"></mutation>
        <title name="PROPERTY">EVEN</title>
      </block>
      <block type="math_change">
        <title name="VAR">item</title>
        <value name="DELTA">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
      </block>
      <block type="math_round">
        <title name="OP">ROUND</title>
      </block>
      <block type="math_on_list">
        <title name="OP">SUM</title>
      </block>
      <block type="math_modulo"></block>
      <block type="math_constrain" >
        <value name="LOW">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
        <value name="HIGH">
          <block type="math_number">
            <title name="NUM">100</title>
          </block>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <title name="NUM">100</title>
          </block>
        </value>
      </block>
      <block type="math_random_float"></block>
    </category>
    <category name="Text">
      <block type="text"  >
        <title name="TEXT"></title>
      </block>
      <block type="text_join" inline="false"  >
        <mutation items="2"></mutation>
      </block>
      <block type="text_append" inline="false"  >
        <title name="VAR">item</title>
        <value name="TEXT">
          <block type="text">
            <title name="TEXT"></title>
          </block>
        </value>
      </block>
      <block type="text_length" inline="false"  ></block>
      <block type="text_isEmpty" inline="true"  ></block>
      <block type="text_indexOf" inline="true"  >
        <title name="END">FIRST</title>
        <value name="VALUE">
          <block type="variables_get">
            <title name="VAR">text</title>
          </block>
        </value>
      </block>
      <block type="text_charAt" inline="true"  >
        <mutation at="true"></mutation>
        <title name="WHERE">FROM_START</title>
        <value name="VALUE">
          <block type="variables_get">
            <title name="VAR">text</title>
          </block>
        </value>
      </block>
      <block type="text_charCodeAt" inline="true"  >
        <value name="STR">
          <block type="variables_get">
            <title name="VAR">text</title>
          </block>
        </value>
        <value name="POS">
          <block type="math_number">
            <title name="NUM">1</title>
          </block>
        </value>
      </block>
      <block type="text_fromcharcode" inline="true">
        <value name="CHARCODE">
          <block type="math_number">
            <title name="NUM">10</title>
          </block>
        </value>
      </block>
      <block type="text_getSubstring" inline="true"  >
        <mutation at1="true" at2="true"></mutation>
        <title name="WHERE1">FROM_START</title>
        <title name="WHERE2">FROM_START</title>
        <value name="STRING">
          <block type="variables_get">
            <title name="VAR">text</title>
          </block>
        </value>
      </block>
      <block type="text_changeCase" inline="false"  >
        <title name="CASE">UPPERCASE</title>
      </block>
      <block type="text_trim" inline="false"  >
        <title name="MODE">BOTH</title>
      </block>
      <block type="text_print" inline="false"  ></block>
      <block type="json_stringify" inline="true"  ></block>
      <block type="json_parse" inline="true"  ></block>
    </category>
    <category name="Lists">
      <block type="variables_set"><title name="VAR">list</title><value name="VALUE">
          <block type="lists_create_empty"  ></block>
      </value></block>
      <block type="variables_set"><title name="VAR">list</title><value name="VALUE">
        <block type="lists_create_with" inline="false"  >
          <mutation items="3"></mutation>
        </block>
      </value></block>
      <block type="variables_set"><title name="VAR">list</title><value name="VALUE">
        <block type="lists_repeat" inline="true"  >
          <value name="NUM">
            <block type="math_number">
              <title name="NUM">5</title>
            </block>
          </value>
        </block>
      </value></block>
      <block type="lists_length" inline="false"  ></block>
      <block type="lists_isEmpty" inline="true"  ></block>
      <block type="lists_indexOf" inline="true"  >
        <title name="END">FIRST</title>
        <value name="VALUE">
          <block type="variables_get">
            <title name="VAR">list</title>
          </block>
        </value>
      </block>
      <block type="lists_getIndex" inline="true"  >
        <mutation statement="false" at="true"></mutation>
        <title name="MODE">GET</title>
        <title name="WHERE">FROM_START</title>
        <value name="VALUE">
          <block type="variables_get">
            <title name="VAR">list</title>
          </block>
        </value>
      </block>
      <block type="lists_setIndex" inline="true"  >
        <mutation at="true"></mutation>
        <title name="MODE">SET</title>
        <title name="WHERE">FROM_START</title>
        <value name="LIST">
          <block type="variables_get">
            <title name="VAR">list</title>
          </block>
        </value>
      </block>
      <block type="lists_getSublist" inline="true"  >
        <mutation at1="true" at2="true"></mutation>
        <title name="WHERE1">FROM_START</title>
        <title name="WHERE2">FROM_START</title>
        <value name="LIST">
          <block type="variables_get">
            <title name="VAR">list</title>
          </block>
        </value>
      </block>
    </category>   
    <category name="Variables">
      <block type="variables_set" inline="false"  >
        <title name="VAR">item</title>
      </block>
      <block type="variables_get"  >
        <title name="VAR">item</title>
      </block>    
    </category>
    <!--<category name="Procedures">       
      <block type="procedures_defnoreturn"  >
        <mutation></mutation>
        <title name="NAME">do something</title>
      </block>
      <block type="procedures_defreturn" inline="false"  >
        <mutation></mutation>
        <title name="NAME">do something2</title>
      </block>
      <block type="procedures_ifreturn" inline="true"  >
        <mutation value="1"></mutation>
      </block>
      TODO - need to auto-add calls here?? 
    </category> -->
    <category name="Espruino">
      <block type="espruino_timeout">
        <value name="SECONDS"><block type="math_number"><title name="NUM">1</title></block></value>
      </block>
      <block type="espruino_clear_timeout">
      </block>
      <block type="espruino_interval">
        <value name="SECONDS"><block type="math_number"><title name="NUM">1</title></block></value>
      </block>
      <block type="espruino_clear_interval">
      </block>
      <block type="espruino_change_interval">
        <value name="SECONDS"><block type="math_number"><title name="NUM">1</title></block></value>
      </block>
      <block type="espruino_getTime"></block>
      <block type="espruino_pin"></block>
      <block type="espruino_PWM_pin"></block>
      <block type="espruino_BTN_pin"></block>
      <block type="espruino_LED_pin"></block>
      <block type="espruino_watch">
        <value name="PIN"><block type="espruino_BTN_pin"><title name="PIN">BTN1</title></block></value>
        <value name="DEBOUNCE"><block type="math_number"><title name="NUM">100</title></block></value>
      </block>
      <block type="espruino_digitalWrite">
        <value name="PIN"><block type="espruino_LED_pin"><title name="PIN">LED1</title></block></value>
      </block>
      <block type="espruino_digitalPulse">
        <value name="PIN"><block type="espruino_LED_pin"><title name="PIN">LED1</title></block></value>
        <value name="VAL"><block type="logic_boolean"><title name="BOOL">TRUE</title></block></value>
        <value name="TIME"><block type="math_number"><title name="NUM">100</title></block></value>
      </block>
      <block type="espruino_digitalRead">
        <value name="PIN"><block type="espruino_BTN_pin"><title name="PIN">BTN1</title></block></value>
      </block>
      <block type="espruino_analogWrite">
        <value name="PIN"><block type="espruino_pin"><title name="PIN">A1</title></block></value>
	<value name="VAL"><block type="math_number"><title name="NUM">100</title></block></value>
	<value name="FREQ"><block type="math_number"><title name="NUM">100</title></block></value>
      </block>
      <block type="espruino_analogRead">
        <value name="PIN"><block type="espruino_pin"><title name="PIN">A0</title></block></value>
      </block>
      <block type="espruino_code">
      </block>
    </category>
    <category name="Wifi">
      <block type="esp8266_connect">
	<field name="SER">Serial6</field>
        <value name="RX"><block type="espruino_pin"><title name="PIN">C7</title></block></value>
        <value name="TX"><block type="espruino_pin"><title name="PIN">C6</title></block></value>
        <value name="BAUD"><block type="math_number"><title name="NUM">115200</title></block></value>
      </block>
      <block type="connect_ssid">
      </block>
      <block type="createap"></block>
      <block type="getconnecteddevices"></block>
      <block type="get_IP">
      </block>
      <block type="get_APs">
      </block>
      <block type="get_version">
      </block>
      <block type="get_connected">
      </block>
      <block type="create_server">
        <value name="PORT"><block type="math_number"><title name="NUM">8080</title></block></value>
      </block>
      <block type="connect_server">
        <value name="PORT"><block type="math_number"><title name="NUM">8080</title></block></value>
      </block>
      <block type="send_data">
      </block>
      <block type="bind_callbacks">
      </block>
    </category>
    <category name="Web">
      <block type="create_web_server">
        <value name="PORT"><block type="math_number"><title name="NUM">80</title></block></value>
      </block>
      <block type="read_objects_property_" inline="false">
        <mutation items="1"></mutation>
      </block>
      <block type="url_parse"></block>
      <block type="httpsrs_end"></block>
      <block type="httpsrs_writehead">
        <value name="CODE"><block type="math_number"><title name="NUM">200</title></block></value>
      </block>
      <block type="http_get"></block>
    </category>
    <category name="LCD">
      <block type="lcd_display_init">
        <value name="RS"><block type="espruino_pin"><title name="PIN">A0</title></block></value>
        <value name="E"><block type="espruino_pin"><title name="PIN">A1</title></block></value>
        <value name="D4"><block type="espruino_pin"><title name="PIN">C0</title></block></value>
        <value name="D5"><block type="espruino_pin"><title name="PIN">C1</title></block></value>
        <value name="D6"><block type="espruino_pin"><title name="PIN">C2</title></block></value>
        <value name="D7"><block type="espruino_pin"><title name="PIN">C3</title></block></value>
      </block>lcd_display_clear
      <block type="lcd_display_clear"></block>
      <block type="lcd_display_print"></block>
      <block type="lcd_display_set_cursor"></block>
      <block type="lcd_display_create_char"></block>
    </category>
    <category name="Modules">
      <block type="switch"></block>
      <block type="watch_switch">
        <value name="DEBOUNCE"><block type="math_number"><title name="NUM">100</title></block></value>
      </block>
      <block type="potenciometer"></block>
      <block type="motor_driver">
        <value name="speed"><block type="math_number"><title name="NUM">1</title></block></value>
      </block>
      <block type="encoder_connect">
        <value name="HOLES"><block type="math_number"><title name="NUM">12</title></block></value>
      </block>
      <block type="encoder_reset"></block>
      <block type="encoder_get"></block>
      <block type="servo_move">
        <value name="PIN"><block type="espruino_pin"><title name="PIN">A1</title></block></value>
        <value name="POS"><block type="math_number"><title name="NUM">1</title></block></value>
      </block>
      <block type="espruino_ebr00043l"></block>	
      <block type="hcsr04_def"></block>
      <block type="HCSR04_read">
        <value name="sensor"><block type="variables_get"><title name="VAR">item</title></block></value>
      </block>
      <block type="YL64_def">
        <value name="S0"><block type="espruino_pin"><title name="PIN">A0</title></block></value>
        <value name="S1"><block type="espruino_pin"><title name="PIN">A1</title></block></value>
        <value name="S2"><block type="espruino_pin"><title name="PIN">A2</title></block></value>
        <value name="S3"><block type="espruino_pin"><title name="PIN">A3</title></block></value>
        <value name="OUT"><block type="espruino_pin"><title name="PIN">A4</title></block></value>
      </block>
      <block type="YL64_read">
        <value name="sensor"><block type="variables_get"><title name="VAR">item</title></block></value>
      </block>
      <block type="spi_setup">
        <value name="MISO"><block type="espruino_pin"><title name="PIN">B4</title></block></value>
        <value name="MOSI"><block type="espruino_pin"><title name="PIN">B5</title></block></value>
        <value name="SCK"><block type="espruino_pin"><title name="PIN">B3</title></block></value>
      </block>
      <block type="rc522_init">
        <value name="CS"><block type="espruino_pin"><title name="PIN">B2</title></block></value>
      </block>
      <block type="rc522_findcards"></block>
    </category>
    <category name="Functions" custom="PROCEDURE"></category>
  </xml>

    <!-- Blockly initial code -->
<xml id="blocklyInitial" style="display: none">
<block type="variables_set" inline="false"><field name="VAR">Intr</field><value name="VALUE"><block type="espruino_interval" inline="true"><value name="SECONDS"><block type="math_number"><field name="NUM">0.5</field></block></value><statement name="DO"><block type="espruino_digitalWrite" inline="true"><value name="PIN"><block type="espruino_LED_pin"><field name="PIN">RED2</field></block></value><value name="VAL"><block type="logic_negate"  inline="false"><value name="BOOL"><block type="espruino_digitalRead" inline="true"><value name="PIN"><block type="espruino_LED_pin"><field name="PIN">RED2</field></block></value></block></value></block></value></block></statement></block></value><next><block type="espruino_digitalWrite" inline="true"><value name="PIN"><block type="espruino_LED_pin"><field name="PIN">RED1</field></block></value><value name="VAL"><block type="math_number"><field name="NUM">1</field></block></value><next><block type="variables_set" inline="false"><field name="VAR">tOut</field><value name="VALUE"><block type="espruino_timeout" inline="true"><value name="SECONDS"><block type="math_number"><field name="NUM">5</field></block></value><statement name="DO"><block type="espruino_digitalWrite" inline="true"><value name="PIN"><block type="espruino_LED_pin"><field name="PIN">RED1</field></block></value><value name="VAL"><block type="math_number"><field name="NUM">0</field></block></value><next><block type="espruino_clear_interval" inline="true"><value name="INTERVAL"><block type="variables_get"><field name="VAR">Intr</field></block></value></block></next></block></statement></block></value></block></next></block></next></block></xml>

  </body>
</html>
